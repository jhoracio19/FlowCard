{% extends 'base.html' %}

{% block title %}Historial de Pagos - FlowCard{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 py-10">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-6">
        <div>
            <h1 class="text-4xl font-black text-slate-900 tracking-tight">Historial de Pagos</h1>
            <p class="text-slate-500 font-medium mt-1">Registro histórico de tus estados de cuenta liquidados.</p>
        </div>
        <a href="{% url 'cards:dashboard' %}" class="group flex items-center gap-2 bg-white px-5 py-2.5 rounded-xl border border-slate-200 text-slate-600 font-bold text-sm shadow-sm hover:border-slate-900 hover:text-slate-900 transition-all">
            <i class="fa-solid fa-arrow-left transition-transform group-hover:-translate-x-1"></i>
            Regresar al Dashboard
        </a>
    </div>

    <div class="bg-white rounded-[2.5rem] shadow-2xl shadow-slate-200/50 border border-slate-50 overflow-hidden">
        <div class="overflow-x-auto">
            <table class="min-w-full border-collapse">
                <thead>
                    <tr class="bg-slate-900">
                        <th class="px-8 py-5 text-left text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Institución / Tarjeta</th>
                        <th class="px-8 py-5 text-left text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Periodo Facturado</th>
                        <th class="px-8 py-5 text-left text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Monto Liquidado</th>
                        <th class="px-8 py-5 text-center text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Estado</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-slate-100">
                    {% for statement in paid_statements %}
                    <tr class="hover:bg-slate-50/50 transition-colors group">
                        <td class="px-8 py-6 whitespace-nowrap">
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center text-white font-black text-xs shadow-lg" 
                                     style="background-color: {{ statement.card.color|default:'#0f172a' }};">
                                    {{ statement.card.bank_name|slice:":1" }}
                                </div>
                                <div>
                                    <div class="text-sm font-black text-slate-900">{{ statement.card.bank_name }}</div>
                                    <div class="text-[11px] font-bold text-slate-400 uppercase tracking-tighter">{{ statement.card.card_name }}</div>
                                </div>
                            </div>
                        </td>
                        
                        <td class="px-8 py-6 whitespace-nowrap">
                            <div class="flex items-center gap-2 text-sm font-bold text-slate-600">
                                <i class="fa-regular fa-calendar text-slate-300"></i>
                                {{ statement.month_year|date:"F Y" }}
                            </div>
                        </td>
                        
                        <td class="px-8 py-6 whitespace-nowrap">
                            <span class="text-base font-black text-blue-700 tabular-nums">
                                ${{ statement.non_interest_payment }}
                            </span>
                        </td>
                        
                        <td class="px-8 py-6 whitespace-nowrap text-center">
                            <span class="inline-flex items-center gap-1.5 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest bg-emerald-50 text-emerald-600 border border-emerald-100">
                                <i class="fa-solid fa-check-double text-[8px]"></i>
                                Liquidado
                            </span>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="px-8 py-20 text-center">
                            <div class="max-w-xs mx-auto">
                                <div class="w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-slate-100">
                                    <i class="fa-solid fa-box-open text-slate-300 text-2xl"></i>
                                </div>
                                <h3 class="text-slate-900 font-black text-sm uppercase tracking-widest">Sin registros</h3>
                                <p class="text-slate-400 text-xs mt-2 italic">Aún no has marcado ningún estado de cuenta como pagado.</p>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="bg-slate-50/50 px-8 py-4 border-t border-slate-100">
            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2">
                <i class="fa-solid fa-lock text-slate-300"></i>
                Resumen de Transacciones Verificadas
            </p>
        </div>
    </div>
</div>

<style>
    /* Estilo para suavizar la tabla en móviles */
    @media (max-width: 640px) {
        .max-w-6xl { padding-top: 2rem; }
    }
    
    /* Efecto de elevación en la fila al hacer hover */
    tbody tr:hover {
        position: relative;
        z-index: 10;
        box-shadow: 0 4px 20px -5px rgba(15, 23, 42, 0.05);
    }
</style>
{% endblock %}